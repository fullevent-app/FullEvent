---
title: expressWideLogger
description: Express middleware for Wide Event logging.
---

# expressWideLogger

Express middleware for Wide Event logging.

Creates a single, rich event per request that captures the complete context.
The event is initialized with request data and automatically finalized with
status, duration, and outcome. Your handlers enrich it with business context.

## How It Works

1. **Request Start**: Middleware creates the event with request context
2. **Handler Runs**: Your code enriches the event via `req.wideEvent`
3. **Response Finish**: Middleware adds status/duration and sends to FullEvent

## Features

- **Automatic context capture**: method, path, status, duration
- **Distributed tracing**: Propagates `x-fullevent-trace-id` headers
- **Tail-based sampling**: 100% error visibility at any sample rate
- **Fire and forget**: Non-blocking, won't slow down your responses

## API Reference

<APIReference>
<APIMethod name="expressWideLogger(config)" category="Function">
<APIMethodContent>
<APIMethodLeft>
<APIDescription note="Creates a single, rich event per request that captures the complete context.">
Express middleware for Wide Event logging.
</APIDescription>

<APIParameters>
<APIParam name="config" type="WideLoggerConfig" required>
Middleware configuration
</APIParam>
</APIParameters>

<APIReturns type="void">Express middleware function</APIReturns>
</APIMethodLeft>
<APIMethodRight>
<APISignature>{`expressWideLogger(config: WideLoggerConfig): void`}</APISignature>
<APIExamples>{`import express from 'express';
import { expressWideLogger } from '@fullevent/node-sdk';

const app = express();

app.use(expressWideLogger({
  apiKey: process.env.FULLEVENT_API_KEY!,
  service: 'checkout-api',
}));`}</APIExamples>
</APIMethodRight>
</APIMethodContent>
</APIMethod>
</APIReference>

## More Examples

### Enriching Events

```typescript
app.post('/checkout', async (req, res) => {
  const event = req.wideEvent;
  
  // Add user context
  event.user = {
    id: req.user.id,
    subscription: req.user.plan,
  };
  
  // Add cart context
  event.cart = {
    id: cart.id,
    item_count: cart.items.length,
    total_cents: cart.total,
  };
  
  // Add payment timing
  const paymentStart = Date.now();
  const payment = await processPayment(cart);
  event.payment = {
    provider: 'stripe',
    latency_ms: Date.now() - paymentStart,
  };
  
  res.json({ orderId: payment.orderId });
});
```

### With Sampling

```typescript
app.use(expressWideLogger({
  apiKey: process.env.FULLEVENT_API_KEY!,
  service: 'checkout-api',
  sampling: {
    defaultRate: 0.1,           // 10% of normal traffic
    alwaysKeepErrors: true,     // 100% of errors
    slowRequestThresholdMs: 500, // Slow requests
  },
}));
```
